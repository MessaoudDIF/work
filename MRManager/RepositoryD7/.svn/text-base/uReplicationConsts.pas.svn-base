unit uReplicationConsts;

interface

const
  REPCOLUMN                 = 'ReplLastChange';
  REP_DELETION_TABLE        = 'Rpl_RowDeleted';
  REP_DELETION_TABLE_SCRIPT = 'Script';
  REP_DELETION_TABLE_NAME   = 'TableName';

  PK_COLUMN_NAME = 'Coluna';
  CRLF = #13#10;

  { ANSI }
  ANSI_FMT_TABLE_SELECT        = 'SELECT * FROM %S (NOLOCK) WHERE (1 = 0)';
  ANSI_FMT_TABLE_SELECT_FILEDS = 'SELECT %S FROM %S (NOLOCK)';
  ANSI_FMT_SQL_UPDATE          = 'UPDATE %S SET ';
  ANSI_FMT_SQL_SELECT          = 'SELECT %S FROM %S (NOLOCK) ';
  ANSI_FMT_SQL_INSERT          = 'INSERT INTO %S (%S) VALUES (%S)';



  { MSSQL2000 - Microsoft SQL Server 2000 }
  MSSQL2000_SELECT_PK =
    'SELECT' + CRLF +
    '	KCU.COLUMN_NAME AS Coluna,' + CRLF +
    '	KCU.ORDINAL_POSITION AS Ordem' + CRLF +
    'FROM' + CRLF +
    '	INFORMATION_SCHEMA.TABLE_CONSTRAINTS TC' + CRLF +
    '	INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE KCU ON (TC.CONSTRAINT_NAME = KCU.CONSTRAINT_NAME)' + CRLF +
    'WHERE' + CRLF +
    '	TC.CONSTRAINT_TYPE ='#39'PRIMARY KEY'#39 + CRLF +
    '	AND' + CRLF +
    '	TC.TABLE_NAME = '#39'%S'#39 + CRLF +
    '	AND' + CRLF +
    '	KCU.TABLE_CATALOG = '#39'%S'#39 + CRLF +
    'ORDER BY' + CRLF +
    '	KCU.ORDINAL_POSITION';

  MSSQL2000_SELECT_FK =
    'SELECT' + CRLF +
    '	FC.TABLE_NAME AS TabelaDerivada,' + CRLF +
    '	FC.COLUMN_NAME AS ChaveEstrangeira,' + CRLF +
    '	DC.COLUMN_NAME AS ChaveOriginal,' + CRLF +
    '	DC.TABLE_NAME AS TabelaOriginal,' + CRLF +
    '	RC.CONSTRAINT_NAME AS ConstraintName' + CRLF +
    'FROM' + CRLF +
    '	INFORMATION_SCHEMA.KEY_COLUMN_USAGE FC' + CRLF +
    '	INNER JOIN INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS RC' + CRLF +
    '		ON (FC.CONSTRAINT_NAME = RC.CONSTRAINT_NAME)' + CRLF +
    '	INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE DC' + CRLF +
    '		ON (RC.UNIQUE_CONSTRAINT_NAME = DC.CONSTRAINT_NAME)';

  MSSQL2000_WHERE_REP_SINCE = 'IsNull(ReplLastChange, GETDATE()) >= CONVERT(DATETIME, DATEDIFF(DAY, %D, GETDATE()))';

  MSSQL2000_CMD_DISABLE_ALL_TRIGGERS = 'ALTER TABLE %S DISABLE TRIGGER ALL';

  MSSQL2000_CMD_ENABLE_ALL_TRIGGERS = 'ALTER TABLE %S ENABLE TRIGGER ALL';

  MSSQL2000_CMD_ENABLE_CONSTRAINT =
    'ALTER TABLE %S CHECK CONSTRAINT %S';

  MSSQL2000_CMD_DISABLE_CONSTRAINT =
    'ALTER TABLE %S NOCHECK CONSTRAINT %S';



  MSSQL2000_CMD_REPLICATE_BATCH_BEGIN = 'SET NOCOUNT ON';

  MSSQL2000_CMD_REPLICATE_BATCH_BODY =
    '%S' + CRLF +
    'IF @@ROWCOUNT = 0' + CRLF +
    '	BEGIN' + CRLF +
    '	  %S' + CRLF +
    '	END';

  MSSQL2000_CMD_REPLICATE_BATCH_END = 'SET NOCOUNT OFF';

implementation

end.
